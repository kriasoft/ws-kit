import{x as o,b as t,i as s,p as r}from"./chunks/framework.Dl5MHC_T.js";const g=JSON.parse('{"title":"Build Error Summary (Current as of 2025-11-15)","description":"","frontmatter":{},"headers":[],"relativePath":"issues/typecheck.local.md","filePath":"issues/typecheck.local.md","lastUpdated":0}'),c={name:"issues/typecheck.local.md"};function a(d,e,i,n,l,p){return s(),t("div",null,[...e[0]||(e[0]=[r('<h1 id="build-error-summary-current-as-of-2025-11-15" tabindex="-1">Build Error Summary (Current as of 2025-11-15) <a class="header-anchor" href="#build-error-summary-current-as-of-2025-11-15" aria-label="Permalink to “Build Error Summary (Current as of 2025-11-15)”">​</a></h1><p><strong>Total Errors</strong>: ~42 TypeScript compilation errors across 9 packages</p><h2 id="_1-adapter-and-handler-issues-bun-cloudflare" tabindex="-1">1. Adapter and Handler Issues (Bun &amp; Cloudflare) <a class="header-anchor" href="#_1-adapter-and-handler-issues-bun-cloudflare" aria-label="Permalink to “1. Adapter and Handler Issues (Bun &amp; Cloudflare)”">​</a></h2><p><strong>Count</strong>: 6 errors | <strong>Files</strong>: <code>packages/bun/src/adapter.ts</code>, <code>packages/bun/src/handler.ts</code>, <code>packages/cloudflare/src/adapter.ts</code>, <code>packages/cloudflare/src/handler.ts</code></p><p><strong>Problem</strong>: Adapter initialization and handler registration fail due to missing interface compliance.</p><p><strong>Errors</strong>:</p><ul><li><code>packages/bun/src/adapter.ts:32</code> — Type <code>{}</code> missing: <code>getServerWebSocket</code>, <code>close</code>, <code>send</code></li><li><code>packages/bun/src/adapter.ts:61</code> — Property <code>pubsub</code> doesn&#39;t exist on <code>PlatformAdapter</code></li><li><code>packages/bun/src/handler.ts:101</code> — Can&#39;t cast <code>{ clientId, connectedAt }</code> to <code>BunWebSocketData&lt;TContext&gt;</code></li><li><code>packages/bun/src/handler.ts:149</code> — Handler type mismatch: <code>ServerWebSocket</code> parameter incompatibility</li><li><code>packages/bun/src/handler.ts:199</code> — <code>Buffer&lt;ArrayBufferLike&gt;</code> not assignable to <code>string | ArrayBuffer</code></li><li><code>packages/bun/src/handler.ts:221</code> — Property <code>data</code> missing on <code>ServerWebSocket</code></li><li><code>packages/cloudflare/src/adapter.ts:35</code> — Property <code>pubsub</code> doesn&#39;t exist on <code>PlatformAdapter</code></li><li><code>packages/cloudflare/src/handler.ts:101</code> — Can&#39;t cast connection data to <code>DurableObjectWebSocketData&lt;TContext&gt;</code></li></ul><p><strong>Root Cause</strong>: <code>ServerWebSocket</code> isn&#39;t generic; can&#39;t attach typed data properties. Adapter interface doesn&#39;t define <code>pubsub</code>.</p><hr><h2 id="_2-missing-incorrect-exports-from-ws-kit-core" tabindex="-1">2. Missing/Incorrect Exports from @ws-kit/core <a class="header-anchor" href="#_2-missing-incorrect-exports-from-ws-kit-core" aria-label="Permalink to “2. Missing/Incorrect Exports from @ws-kit/core”">​</a></h2><p><strong>Count</strong>: 3 errors | <strong>Files</strong>: <code>packages/bun/src/pubsub.ts</code>, <code>packages/cloudflare/src/pubsub.ts</code>, <code>packages/rate-limit/src/middleware.ts</code></p><p><strong>Errors</strong>:</p><ul><li><code>packages/bun/src/pubsub.ts:4</code> — No exported member <code>PubSub</code></li><li><code>packages/bun/src/pubsub.ts:4</code> — No exported member <code>PubSubPublishOptions</code> (suggests <code>PublishOptions</code>)</li><li><code>packages/cloudflare/src/pubsub.ts:4</code> — No exported member <code>PubSub</code></li><li><code>packages/rate-limit/src/middleware.ts:188</code> — No exported member <code>IngressContext</code></li></ul><p><strong>Root Cause</strong>: Refactoring moved/renamed exports without updating imports in dependent packages.</p><hr><h2 id="_3-type-constraint-violations" tabindex="-1">3. Type Constraint Violations <a class="header-anchor" href="#_3-type-constraint-violations" aria-label="Permalink to “3. Type Constraint Violations”">​</a></h2><p><strong>Count</strong>: 18 errors | <strong>Files</strong>: <code>packages/bun/src/types.ts</code>, <code>packages/cloudflare/src/types.ts</code>, <code>packages/client/valibot/src/index.ts</code>, <code>packages/client/zod/src/index.ts</code></p><p><strong>Errors</strong>:</p><ul><li><code>packages/bun/src/types.ts:67</code> — Type <code>T</code> doesn&#39;t satisfy constraint <code>Record&lt;string, unknown&gt;</code></li><li><code>packages/cloudflare/src/types.ts:11</code> — Type <code>T</code> doesn&#39;t satisfy constraint <code>Record&lt;string, unknown&gt;</code></li><li><code>packages/client/valibot/src/index.ts</code> — Multiple instances (42, 81, 90, 92, 101, 109, 112×2, 122×2): Type <code>S</code> doesn&#39;t satisfy <code>MessageSchemaType</code> (missing <code>entries</code>, <code>message</code> properties)</li><li><code>packages/client/zod/src/index.ts</code> — Multiple instances (42, 80, 89, 91, 100, 108, 111×2, 121×2): Type <code>S</code> doesn&#39;t satisfy <code>{ readonly [SchemaTag]?: any; }</code></li></ul><p><strong>Root Cause</strong>: Validator schemas don&#39;t match expected constraint types. Likely due to recent schema/descriptor changes.</p><hr><h2 id="_4-pubsub-core-and-plugin-issues" tabindex="-1">4. PubSub Core and Plugin Issues <a class="header-anchor" href="#_4-pubsub-core-and-plugin-issues" aria-label="Permalink to “4. PubSub Core and Plugin Issues”">​</a></h2><p><strong>Count</strong>: 12 errors | <strong>Files</strong>: <code>packages/pubsub/src/core/topics.ts</code>, <code>packages/pubsub/src/plugin.ts</code>, <code>packages/pubsub/src/test-utils.ts</code></p><p><strong>Errors</strong>:</p><ul><li><code>packages/pubsub/src/core/topics.ts</code> — Multiple lines (404, 536, 683, 693, 792, 801, 1022, 1031, 1275, 1289, 1306, 1315): Object type <code>unknown</code> — lack of type guards</li><li><code>packages/pubsub/src/plugin.ts:130</code> — Return type mismatch: <code>topics.list()</code> returns <code>Promise&lt;readonly string[]&gt;</code> but interface expects <code>readonly string[]</code></li><li><code>packages/pubsub/src/plugin.ts:264</code> — <code>MessageDescriptor</code> missing property <code>name</code></li><li><code>packages/pubsub/src/plugin.ts:418,426</code> — Duplicate <code>pubsub</code> property in object literal</li><li><code>packages/pubsub/src/test-utils.ts:130</code> — Return type <code>StopFn | Promise&lt;StopFn&gt; | undefined</code> doesn&#39;t match expected <code>(() =&gt; void | Promise&lt;void&gt;) | Promise&lt;() =&gt; void | Promise&lt;void&gt;&gt;</code></li></ul><p><strong>Root Cause</strong>: Plugin API shape mismatch (async <code>topics.list()</code> vs sync expected). Schema descriptors missing <code>name</code>. Type narrowing issues with unknown.</p><hr><h2 id="_5-rate-limit-middleware-type-issues" tabindex="-1">5. Rate-Limit Middleware Type Issues <a class="header-anchor" href="#_5-rate-limit-middleware-type-issues" aria-label="Permalink to “5. Rate-Limit Middleware Type Issues”">​</a></h2><p><strong>Count</strong>: 5 errors | <strong>Files</strong>: <code>packages/rate-limit/src/keys.ts</code>, <code>packages/rate-limit/src/middleware.ts</code></p><p><strong>Errors</strong>:</p><ul><li><code>packages/rate-limit/src/keys.ts:119</code> — Property <code>ip</code> doesn&#39;t exist on <code>IngressContext&lt;TData&gt;</code></li><li><code>packages/rate-limit/src/middleware.ts:118</code> — Middleware signature mismatch: expects <code>MinimalContext&lt;TData&gt;</code> with <code>payload</code>, <code>send</code> properties</li><li><code>packages/rate-limit/src/middleware.ts:137</code> — Property <code>meta</code> doesn&#39;t exist on <code>MessageContext</code></li><li><code>packages/rate-limit/src/middleware.ts:139</code> — Property <code>data</code> doesn&#39;t exist on <code>ServerWebSocket</code></li><li><code>packages/rate-limit/src/middleware.ts:140</code> — Property <code>receivedAt</code> doesn&#39;t exist on <code>MessageContext</code></li><li><code>packages/rate-limit/src/middleware.ts:148</code> — Property <code>error</code> doesn&#39;t exist on <code>MessageContext</code></li></ul><p><strong>Root Cause</strong>: Rate-limit middleware expects a different context signature than what&#39;s currently provided. Missing context properties or type mismatch.</p><hr><h2 id="root-causes-priority-order" tabindex="-1">Root Causes (Priority Order) <a class="header-anchor" href="#root-causes-priority-order" aria-label="Permalink to “Root Causes (Priority Order)”">​</a></h2><ol><li><strong>Export misalignment</strong> — <code>PubSub</code>, <code>PubSubPublishOptions</code>, <code>IngressContext</code> don&#39;t exist in @ws-kit/core</li><li><strong>Adapter interface mismatch</strong> — <code>PlatformAdapter</code> doesn&#39;t define <code>pubsub</code> property; handlers can&#39;t attach <code>.data</code></li><li><strong>PubSub API shape</strong> — <code>topics.list()</code> is async but interface expects sync; duplicate properties in plugin return</li><li><strong>Schema descriptor changes</strong> — Validators don&#39;t match constraints; <code>MessageDescriptor</code> missing <code>name</code></li><li><strong>Context type fragmentation</strong> — Rate-limit expects different properties than core provides</li><li><strong>Type guard gaps</strong> — <code>unknown</code> type issues in pubsub topics</li></ol><hr><h2 id="recommended-fix-priority" tabindex="-1">Recommended Fix Priority <a class="header-anchor" href="#recommended-fix-priority" aria-label="Permalink to “Recommended Fix Priority”">​</a></h2><ol><li><strong>Quick wins</strong>: Add missing exports to core (<code>PubSub</code>, <code>IngressContext</code>, rename/alias <code>PubSubPublishOptions</code>)</li><li><strong>Adapter layer</strong>: Define <code>pubsub</code> property on <code>PlatformAdapter</code>; resolve <code>.data</code> property access</li><li><strong>PubSub shape</strong>: Fix <code>topics.list()</code> async/sync mismatch; remove duplicate <code>pubsub</code> in plugin return</li><li><strong>Context contracts</strong>: Align rate-limit context expectations with actual <code>MessageContext</code> API</li><li><strong>Schema constraints</strong>: Review validator adapter contracts for <code>MessageSchemaType</code> and <code>SchemaTag</code></li></ol>',38)])])}const m=o(c,[["render",a]]);export{g as __pageData,m as default};
