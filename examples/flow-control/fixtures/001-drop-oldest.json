{
  "schemaVersion": "1.0.0",
  "fixtureVersion": "1.0.0",
  "name": "001-drop-oldest",
  "description": "Queue full with drop-oldest policy, first message discarded",
  "steps": [
    {
      "actor": "client",
      "action": "SEND",
      "count": 10,
      "msg": { "type": "SEND_DATA", "data": "msg-{i}" }
    },
    {
      "actor": "server",
      "action": "QUEUE_AT_CAPACITY",
      "capacity": 10
    },
    {
      "actor": "client",
      "action": "SEND",
      "msg": { "type": "SEND_DATA", "data": "msg-11" }
    },
    {
      "actor": "server",
      "action": "DROP_OLDEST"
    },
    {
      "actor": "server",
      "action": "SEND",
      "msg": {
        "type": "RESOURCE_EXHAUSTED",
        "policy": "drop-oldest",
        "retryAfterMs": 100,
        "queueDepth": 10
      }
    }
  ],
  "assertions": [{ "server.queue[0]": "msg-2" }, { "server.queue.length": 10 }]
}
